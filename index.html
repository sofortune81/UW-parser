```html
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CSV Data Processor</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.2/papaparse.min.js"></script>
    <style>
        #dropZone {
            border: 2px dashed #ccc;
            padding: 20px;
            text-align: center;
            margin: 20px;
            cursor: pointer;
        }
        #dropZone.dragover {
            background-color: #e1e1e1;
        }
        #errorMessage {
            color: red;
            margin: 10px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }
        th {
            background-color: #f2f2f2;
        }
    </style>
</head>
<body>
    <div id="dropZone">Drag and drop a CSV file here or click to select</div>
    <input type="file" id="csvFile" accept=".csv" style="display: none;">
    <div>
        <label for="mcRatio">Premium/MC * 1,000,000 Threshold (minimum 1):</label>
        <input type="number" id="mcRatio" step="0.01" min="1" value="100">
        <button id="processButton" disabled>Process Data</button>
    </div>
    <div id="errorMessage"></div>
    <table>
        <thead>
            <tr>
                <th>Symbol</th>
                <th>Type</th>
                <th>Total Premium</th>
                <th>Market Cap</th>
                <th>Premium/MC * 1,000,000</th>
            </tr>
        </thead>
        <tbody id="aggregateBody"></tbody>
    </table>

    <script>
        // Initialize drag-and-drop and file input handling
        const dropZone = document.getElementById('dropZone');
        const csvFileInput = document.getElementById('csvFile');
        const processButton = document.getElementById('processButton');
        const errorMessage = document.getElementById('errorMessage');
        const aggregateBody = document.getElementById('aggregateBody');
        const mcRatioInput = document.getElementById('mcRatio');

        let csvData = null;

        // Handle drag-and-drop
        dropZone.addEventListener('dragover', (e) => {
            e.preventDefault();
            dropZone.classList.add('dragover');
        });

        dropZone.addEventListener('dragleave', () => {
            dropZone.classList.remove('dragover');
        });

        dropZone.addEventListener('drop', (e) => {
            e.preventDefault();
            dropZone.classList.remove('dragover');
            const file = e.dataTransfer.files[0];
            if (file && file.name.endsWith('.csv')) {
                parseCSV(file);
            } else {
                showError('Please drop a valid CSV file.');
            }
        });

        // Handle file input click
        dropZone.addEventListener('click', () => {
            csvFileInput.click();
        });

        csvFileInput.addEventListener('change', (e) => {
            const file = e.target.files[0];
            if (file && file.name.endsWith('.csv')) {
                parseCSV(file);
            } else {
                showError('Please select a valid CSV file.');
            }
        });

        // Parse CSV file
        function parseCSV(file) {
            Papa.parse(file, {
                delimiter: "|",
                header: true,
                skipEmptyLines: true,
                transformHeader: header => header.trim(), // Trim spaces from headers
                transform: value => value.replace(/^\uFEFF/, '').trim(), // Remove BOM and trim spaces from values
                complete: function(results) {
                    // Validate required columns
                    const requiredColumns = ['premium', 'marketcap', 'underlying_symbol', 'side', 'type'];
                    const missingColumns = requiredColumns.filter(col => !results.meta.fields.includes(col));
                    if (missingColumns.length > 0) {
                        showError(`Missing required CSV columns: ${missingColumns.join(', ')}`);
                        return;
                    }

                    // Validate data rows
                    csvData = results.data.filter(row => {
                        if (!row.premium || !row.marketcap || !row.underlying_symbol || !row.side || !row.type ||
                            row.premium.trim() === '' || row.marketcap.trim() === '' || row.underlying_symbol.trim() === '' ||
                            row.side.trim() === '' || row.type.trim() === '') {
                            console.warn('Skipping invalid row:', row);
                            return false;
                        }
                        return true;
                    });

                    if (csvData.length === 0) {
                        showError('No valid rows found in the CSV file.');
                        return;
                    }

                    showError(''); // Clear any previous errors
                    console.log('Parsed CSV data:', csvData);
                    processButton.disabled = false; // Enable process button
                },
                error: function(error) {
                    showError('Error parsing CSV: ' + error.message);
                }
            });
        }

        // Display error message
        function showError(message) {
            errorMessage.textContent = message;
        }

        // Function to send alert to Discord webhook
        async function sendDiscordAlert(message) {
            const webhookUrl = 'https://discord.com/api/webhooks/YOUR_WEBHOOK_ID/YOUR_WEBHOOK_TOKEN'; // Replace with your Discord webhook URL
            try {
                await fetch(webhookUrl, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        content: message,
                    }),
                });
                console.log('Discord alert sent:', message);
            } catch (error) {
                console.error('Error sending Discord alert:', error);
            }
        }

        // Process and aggregate data
        processButton.addEventListener('click', () => {
            if (!csvData) {
                showError('No CSV data loaded. Please upload a CSV file.');
                return;
            }

            const mcRatioThreshold = parseFloat(mcRatioInput.value);
            if (isNaN(mcRatioThreshold) || mcRatioThreshold < 1) {
                showError('Please enter a valid threshold of 1 or greater.');
                return;
            }

            // Aggregate data by underlying_symbol and type (P or C separately)
            const aggregates = {};
            csvData.forEach(row => {
                const symbol = row.underlying_symbol;
                const type = row.type.toUpperCase(); // Normalize to uppercase (P or C)
                const premium = parseFloat(row.premium.replace(/,/g, '')); // Remove commas
                const marketcap = parseFloat(row.marketcap.replace(/,/g, '')); // Remove commas
                const side = row.side.toUpperCase(); // Normalize to uppercase

                const key = `${symbol}|${type}`; // Unique key for symbol and type (e.g., LNTH|P, LNTH|C)
                if (!aggregates[key]) {
                    aggregates[key] = {
                        symbol,
                        type,
                        totalPremium: 0,
                        marketcap: marketcap,
                    };
                }

                // Add or subtract premium based on side
                if (side === 'ASK') {
                    aggregates[key].totalPremium += premium;
                } else if (side === 'BID') {
                    aggregates[key].totalPremium -= premium;
                } else {
                    console.warn(`Skipping row with invalid side value: ${side}`);
                }
            });

            // Calculate ratios and filter by MC Ratio threshold
            const tableData = Object.keys(aggregates).map(key => {
                const { symbol, type, totalPremium, marketcap } = aggregates[key];
                const ratio = (marketcap !== 0 && totalPremium > 0) ? (totalPremium / marketcap * 1000000).toFixed(4) : 0;
                return {
                    symbol,
                    type,
                    totalPremium: totalPremium.toLocaleString(),
                    marketcap: marketcap.toLocaleString(),
                    ratio: parseFloat(ratio),
                };
            }).filter(row => row.ratio >= mcRatioThreshold);

            // Sort by ratio descending
            tableData.sort((a, b) => b.ratio - a.ratio);

            // Populate table
            aggregateBody.innerHTML = '';
            tableData.forEach(row => {
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td>${row.symbol}</td>
                    <td>${row.type}</td>
                    <td>${row.totalPremium}</td>
                    <td>${row.marketcap}</td>
                    <td>${row.ratio}</td>
                `;
                aggregateBody.appendChild(tr);

                // Trigger Discord alert if ratio meets or exceeds threshold
                if (row.ratio >= mcRatioThreshold) {
                    sendDiscordAlert(`Alert: ${row.symbol} (${row.type}) has a Premium/MC * 1,000,000 Ratio of ${row.ratio}`);
                }
            });

            if (tableData.length === 0) {
                showError('No data meets the Premium/MC * 1,000,000 threshold.');
            }
        });
    </script>
</body>
</html>
```